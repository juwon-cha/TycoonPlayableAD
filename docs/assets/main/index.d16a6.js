window.__require=function t(e,o,i){function r(a,c){if(!o[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var p=o[a]={exports:{}};e[a][0].call(p.exports,function(t){return r(e[a][1][t]||t)},p,p.exports,t,e,o,i)}return o[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<i.length;a++)r(i[a]);return r}({CatState:[function(t,e,o){"use strict";cc._RF.push(e,"74384OZJLFFL7eDyfQ84GPt","CatState");var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(n<3?r(a):n>3?r(e,o,a):r(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isWorking=!1,e.originalPosition=cc.v3(0,0,0),e.workingDesk=null,e}return r(e,t),n([s],e.prototype,"isWorking",void 0),n([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],DeskState:[function(t,e,o){"use strict";cc._RF.push(e,"1b3baFISNVAv6WfkuP/Cw2c","DeskState");var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(n<3?r(a):n>3?r(e,o,a):r(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOccupied=!1,e}return r(e,t),n([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"fba63pL8yZKv4dGXvum+T37","GameManager");var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(n<3?r(a):n>3?r(e,o,a):r(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./CatState"),c=t("./DeskState"),s=t("./UIManager"),l=cc._decorator,p=l.ccclass,d=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gold=20,e.workCost=1,e.workReward=10,e.upgradeCost=60,e.expandCost=100,e.catPrefab=null,e.timerPrefab=null,e.backgroundSpriteFrame=null,e.uiManager=null,e.gameLayer=null,e.uiLayer=null,e.offices=[],e.MAX_LEVEL=3,e.maxOfficeCount=4,e.currentOfficeCount=1,e._workingCats=[],e._catLine=[],e.catLineSize=10,e.catLineStartX=0,e.catLineStartY=-50,e.catLineSpacing=50,e.officeSize=cc.size(350,350),e.deskSize=cc.size(60,40),e.deskColor=cc.color(150,75,0),e.officeGap=70,e}return r(e,t),e.prototype.onLoad=function(){return this.catPrefab&&this.timerPrefab?this.uiManager?(this.catPool=new cc.NodePool("Cat"),this.timerPool=new cc.NodePool("Timer"),this.initLayers(),this.createOffices(),this.uiManager.createUI(this),this.catLineStartX=0,void(this.catLineStartY=0)):(console.error("UIManager\uac00 Cocos Creator \uc5d0\ub514\ud130\uc5d0\uc11c \uc5f0\uacb0\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),void(this.enabled=!1)):(console.error("Prefab \uc5f0\uacb0 \ud655\uc778 \ud544\uc694"),void(this.enabled=!1))},e.prototype.start=function(){this.initializeCatLine(),this.offices.length>0&&this.focusOnOffice(0)},e.prototype.initLayers=function(){this.gameLayer=new cc.Node("GameLayer"),this.node.addChild(this.gameLayer),this.uiLayer=new cc.Node("UILayer"),this.node.addChild(this.uiLayer),this.uiLayer.zIndex=100;var t=this.uiLayer.addComponent(cc.Widget);t.isAlignTop=!0,t.isAlignBottom=!0,t.isAlignLeft=!0,t.isAlignRight=!0,t.top=0,t.bottom=0,t.left=0,t.right=0},e.prototype.focusOnOffice=function(t){var e=this.offices[t].node.position;cc.tween(this.gameLayer).to(1,{position:cc.v3(-e.x,-e.y,0),scale:1},{easing:"cubicOut"}).start()},e.prototype.zoomOutToViewAll=function(){cc.tween(this.gameLayer).to(1,{position:cc.v3(0,0,0),scale:.55},{easing:"cubicOut"}).start()},e.prototype.getNewCat=function(){var t=null;return(t=this.catPool.size()>0?this.catPool.get():cc.instantiate(this.catPrefab)).getComponent(a.default).isWorking=!1,t},e.prototype.putCat=function(t){this.catPool.put(t)},e.prototype.getNewTimer=function(){return this.timerPool.size()>0?this.timerPool.get():cc.instantiate(this.timerPrefab)},e.prototype.putTimer=function(t){this.timerPool.put(t)},e.prototype.initializeCatLine=function(){for(var t=0;t<this.catLineSize;t++)this.addCatToLine(!1)},e.prototype.addCatToLine=function(t){var e=this.getNewCat(),o=this._catLine.length,i=cc.v3(this.catLineStartX,this.catLineStartY-o*this.catLineSpacing,0);t?(e.setPosition(this.catLineStartX,this.catLineStartY-(o+1)*this.catLineSpacing),cc.tween(e).to(.3,{position:i}).start()):e.setPosition(i),this.gameLayer.addChild(e),this._catLine.push(e)},e.prototype.updateCatLine=function(){for(var t=0;t<this._catLine.length;t++){var e=this._catLine[t],o=cc.v3(this.catLineStartX,this.catLineStartY-t*this.catLineSpacing,0);cc.tween(e).to(.3,{position:o}).start()}this.addCatToLine(!0)},e.prototype.createOffices=function(){for(var t=this.officeSize.width/2+this.officeGap,e=this.officeSize.height/2+this.officeGap,o=[cc.v2(-t,-e),cc.v2(t,-e),cc.v2(-t,e),cc.v2(t,e)],i=0;i<4;i++){var r=new cc.Node("Office_"+i);if(this.gameLayer.addChild(r),r.setPosition(o[i]),this.backgroundSpriteFrame){var n=new cc.Node("Bg"),a=n.addComponent(cc.Sprite);a.spriteFrame=this.backgroundSpriteFrame,a.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.setContentSize(this.officeSize),n.color=0===i?cc.Color.WHITE:cc.Color.GRAY,r.addChild(n,-1,"Bg")}var c={node:r,deskNodes:[],isUnlocked:0===i,level:0};this.createDeskGrid(c),r.opacity=0===i?255:100,this.offices.push(c)}},e.prototype.createDeskGrid=function(t){t.deskNodes.forEach(function(t){return t.destroy()}),t.deskNodes=[];var e=t.node,o=[];t.level>=0&&o.push(cc.v2(0,0)),t.level>=1&&(o.push(cc.v2(-80,0)),o.push(cc.v2(80,0))),t.level>=2&&(o.push(cc.v2(0,60)),o.push(cc.v2(-80,60)),o.push(cc.v2(80,60))),t.level>=3&&(o.push(cc.v2(0,-60)),o.push(cc.v2(-80,-60)),o.push(cc.v2(80,-60)));for(var i=0,r=o;i<r.length;i++){var n=r[i];this.addDesk(e,n,t)}},e.prototype.addDesk=function(t,e,o){var i=new cc.Node("Desk"),r=i.addComponent(cc.Graphics);r.fillColor=this.deskColor,r.rect(-this.deskSize.width/2,-this.deskSize.height/2,this.deskSize.width,this.deskSize.height),r.fill(),i.setPosition(e),i.addComponent(c.default),t.addChild(i),o.deskNodes.push(i)},e.prototype.onClickWork=function(){if(!(this.gold<this.workCost)&&0!==this._catLine.length){for(var t=null,e=0,o=this.offices;e<o.length;e++){var i=o[e];if(i.isUnlocked){for(var r=0,n=i.deskNodes;r<n.length;r++){var a=n[r];if(!a.getComponent(c.default).isOccupied){t=a;break}}if(t)break}}if(!t)return console.log("\ube48 \ucc45\uc0c1\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),void this.uiManager.showToastMessage("\uc790\ub9ac \uc5c6\uc74c");this.gold-=this.workCost,this.uiManager.updateGoldLabel(this.gold);var s=this._catLine.shift();this.updateCatLine(),this.startCatWork(s,t)}},e.prototype.startCatWork=function(t,e){var o=this,i=t.getComponent(a.default),r=e.getComponent(c.default);i.isWorking=!0,r.isOccupied=!0,this._workingCats.push(t);var n=e.parent.convertToWorldSpaceAR(e.position),s=this.gameLayer.convertToNodeSpaceAR(n),l=cc.v3(this.catLineStartX,-cc.winSize.height/2-500,0),p=this.getNewTimer();this.gameLayer.addChild(p);var d=cc.v2(0,50),u=e.convertToWorldSpaceAR(d),h=this.gameLayer.convertToNodeSpaceAR(u);p.setPosition(h),p.active=!1;var f=p.getChildByName("Foreground").getComponent(cc.Sprite);f.fillRange=0,cc.tween(t).to(.5,{position:s},{easing:"cubicOut"}).call(function(){p.active=!0,cc.tween(f).to(2,{fillRange:-1}).start()}).delay(2).call(function(){o.gold+=o.workReward,o.uiManager.updateGoldLabel(o.gold),o.putTimer(p)}).to(.5,{position:l},{easing:"cubicIn"}).call(function(){r.isOccupied=!1;var e=o._workingCats.indexOf(t);e>-1&&o._workingCats.splice(e,1),o.putCat(t)}).start()},e.prototype.onClickUpgrade=function(){var t=this;this.gold<this.upgradeCost||(this.offices[0].level>=this.MAX_LEVEL?console.log("\ucd5c\ub300 \ub808\ubca8\uc785\ub2c8\ub2e4."):(this.gold-=this.upgradeCost,this.upgradeCost*=2,this.offices.forEach(function(e){e.isUnlocked&&e.level<t.MAX_LEVEL&&(e.level++,t.createDeskGrid(e))}),this.uiManager.updateGoldLabel(this.gold),this.uiManager.updateButtonLabels(this)))},e.prototype.onClickExpand=function(){if(!(this.currentOfficeCount>=this.maxOfficeCount||this.gold<this.expandCost)){this.gold-=this.expandCost,this.expandCost*=2;var t=this.currentOfficeCount,e=this.offices[t];e.isUnlocked=!0,e.node.opacity=255,e.node.getChildByName("Bg").color=cc.Color.WHITE;var o=this.offices[0].level;e.level=o,this.createDeskGrid(e),this.currentOfficeCount++,2===this.currentOfficeCount&&this.zoomOutToViewAll(),this.uiManager.updateGoldLabel(this.gold),this.uiManager.updateButtonLabels(this)}},n([d({type:cc.Integer,displayName:"Initial Gold"})],e.prototype,"gold",void 0),n([d({type:cc.Integer,displayName:"Work Cost"})],e.prototype,"workCost",void 0),n([d({type:cc.Integer,displayName:"Work Reward"})],e.prototype,"workReward",void 0),n([d({type:cc.Integer,displayName:"Upgrade Cost"})],e.prototype,"upgradeCost",void 0),n([d({type:cc.Integer,displayName:"Expand Cost"})],e.prototype,"expandCost",void 0),n([d({type:cc.Prefab,displayName:"Cat Prefab"})],e.prototype,"catPrefab",void 0),n([d({type:cc.Prefab,displayName:"Timer Prefab"})],e.prototype,"timerPrefab",void 0),n([d({type:cc.SpriteFrame,displayName:"Background Sprite"})],e.prototype,"backgroundSpriteFrame",void 0),n([d(s.default)],e.prototype,"uiManager",void 0),n([p],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./CatState":"CatState","./DeskState":"DeskState","./UIManager":"UIManager"}],UIManager:[function(t,e,o){"use strict";cc._RF.push(e,"c3a99+64XNMs79RaZS/s2vh","UIManager");var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(n<3?r(a):n>3?r(e,o,a):r(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnSpriteFrame=null,e.uiRootNode=null,e._goldLabel=null,e._buttonLabels=[],e._gameManager=null,e.uiInitialized=!1,e._isWorkButtonPressed=!1,e._workButtonHoldTime=0,e._timeSinceLastWorkCall=0,e._currentWorkCallInterval=.5,e.MIN_WORK_CALL_INTERVAL=.05,e.INITIAL_WORK_CALL_INTERVAL=.5,e.ACCELERATION_FACTOR=.2,e}return r(e,t),e.prototype.createUI=function(t){if(!this.uiInitialized){this.uiInitialized=!0,this._gameManager=t;var e=t.uiLayer,o=cc.winSize,i=new cc.Node("GoldLabelBg"),r=i.addComponent(cc.Sprite);r.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.btnSpriteFrame&&(r.spriteFrame=this.btnSpriteFrame),i.color=cc.color(0,0,0,150),i.width=300,i.height=70,i.setPosition(0,o.height/2-100),e.addChild(i);var n=new cc.Node("GoldLabelText");this._goldLabel=n.addComponent(cc.Label),this._goldLabel.fontSize=40,n.color=cc.Color.WHITE,i.addChild(n);var a=new cc.Node("ButtonContainer");a.width=540,a.height=150,a.setPosition(0,-o.height/2+170),e.addChild(a);for(var c=["\uc77c\uc2dc\ud0a4\uae30","\uc5c5\uadf8\ub808\uc774\ub4dc","\ud655\uc7a5\ud558\uae30"],s=["onClickWork","onClickUpgrade","onClickExpand"],l=0;l<c.length;l++){var p=new cc.Node(c[l]+"Button"),d=p.addComponent(cc.Sprite);d.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.btnSpriteFrame&&(d.spriteFrame=this.btnSpriteFrame),p.width=160,p.height=100,p.color=cc.Color.BLUE;var u=new cc.Node("Label"),h=u.addComponent(cc.Label);if(h.string=c[l],h.fontSize=20,u.color=cc.Color.WHITE,p.addChild(u),this._buttonLabels.push(h),"onClickWork"===s[l])p.on(cc.Node.EventType.TOUCH_START,this.onWorkButtonTouchStart,this),p.on(cc.Node.EventType.TOUCH_END,this.onWorkButtonTouchEnd,this),p.on(cc.Node.EventType.TOUCH_CANCEL,this.onWorkButtonTouchEnd,this);else{var f=p.addComponent(cc.Button);f.transition=cc.Button.Transition.SCALE,f.zoomScale=.95;var g=new cc.Component.EventHandler;g.target=t.node,g.component="GameManager",g.handler=s[l],f.clickEvents.push(g)}var y=190*(l-(c.length-1)/2);p.setPosition(y,0),a.addChild(p)}this.updateGoldLabel(t.gold),this.updateButtonLabels(t)}},e.prototype.onWorkButtonTouchStart=function(t){this._isWorkButtonPressed=!0,this._workButtonHoldTime=0,this._timeSinceLastWorkCall=this.INITIAL_WORK_CALL_INTERVAL,this._currentWorkCallInterval=this.INITIAL_WORK_CALL_INTERVAL,t.stopPropagation()},e.prototype.onWorkButtonTouchEnd=function(){this._isWorkButtonPressed=!1,this._workButtonHoldTime=0},e.prototype.update=function(t){this._isWorkButtonPressed&&(this._workButtonHoldTime+=t,this._timeSinceLastWorkCall+=t,this._currentWorkCallInterval=Math.max(this.MIN_WORK_CALL_INTERVAL,this.INITIAL_WORK_CALL_INTERVAL-this._workButtonHoldTime*this.ACCELERATION_FACTOR),this._timeSinceLastWorkCall>=this._currentWorkCallInterval&&(this._gameManager&&this._gameManager.onClickWork(),this._timeSinceLastWorkCall=0))},e.prototype.updateGoldLabel=function(t){this._goldLabel&&(this._goldLabel.string="Gold: "+t.toString())},e.prototype.updateButtonLabels=function(t){if(3===this._buttonLabels.length){this._buttonLabels[0].string="\uc77c\uc2dc\ud0a4\uae30 ("+t.workCost+"G)";var e=(t.offices.length>0?t.offices[0].level:0)>=t.MAX_LEVEL;this._buttonLabels[1].string=e?"\ucd5c\ub300 \ub808\ubca8":"\ucc45\uc0c1\ud655\uc7a5 ("+t.upgradeCost+"G)";var o=t.currentOfficeCount>=t.maxOfficeCount;this._buttonLabels[2].string=o?"\ucd5c\ub300 \ud655\uc7a5":"\ud655\uc7a5\ud558\uae30 ("+t.expandCost+"G)"}},e.prototype.showToastMessage=function(t){if(this.uiRootNode){var e=new cc.Node("ToastMessage"),o=e.addComponent(cc.Sprite);o.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.btnSpriteFrame&&(o.spriteFrame=this.btnSpriteFrame),e.color=cc.Color.BLACK,e.opacity=200,e.width=400,e.height=80;var i=new cc.Node("Text"),r=i.addComponent(cc.Label);r.string=t,r.fontSize=35,r.lineHeight=40,r.horizontalAlign=cc.Label.HorizontalAlign.CENTER,r.verticalAlign=cc.Label.VerticalAlign.CENTER,i.color=cc.Color.WHITE,e.addChild(i),e.setPosition(0,0),e.zIndex=999,this.uiRootNode.addChild(e),e.scale=0,cc.tween(e).to(.2,{scale:1},{easing:"backOut"}).delay(.8).to(.5,{opacity:0,position:cc.v3(0,100,0)}).call(function(){e.destroy()}).start()}else console.warn("uiRootNode is not set in UIManager. Toast message cannot be shown.")},n([s({type:cc.SpriteFrame,displayName:"Button Sprite"})],e.prototype,"btnSpriteFrame",void 0),n([s({type:cc.Node,displayName:"UI Root (optional)"})],e.prototype,"uiRootNode",void 0),n([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}]},{},["CatState","DeskState","GameManager","UIManager"]);